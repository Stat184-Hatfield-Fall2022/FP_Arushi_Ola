---
title: "NYC Tree Census"
author: "Olachi Mbakwe and Arushi Singh"
date: "`r Sys.Date()`"
output:
  html_document:
    df_print: paged
---

#Exploring the New York Tree Census

As the climate warms, there is more emphasis than ever on preserving and growing natural and natural areas. In a place like New York City, the most populated city in the United States, one would not expect this emphasis to affect change. However, New York City Parks Department, along with other private non-profit organizations have been incredibly successful in promoting the planting of new trees around the city, which benefits the community by providing greenspace and helps mitigate climate change by the increase of tree canopies. To track this change, we got datasets of the New York Tree Census, which occures every 10 years, from a website called NYCOpenData, where agencies can upload data for the public to view at their leisure. We focused on the over number/population of trees, their health, and the most popular species to track these changes.

```{r Data Wrangling, message=FALSE, warning=FALSE, include=FALSE}
#loading packages

library(readr)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(ggmap)
library(kableExtra)
library(janitor)
library(trackdown)

##Bringing in the newyork tree data sets for every 10 years 
nytrees_1995 <- read_csv("~/Desktop/1995_Street_Tree_Census.csv")
nytrees_2005 <- read_csv("~/Desktop/2005_Street_Tree_Census.csv")
nytrees_2015 <- read_csv("~/Desktop/2015_Street_Tree_Census_-_Tree_Data.csv")
#nytrees_species <- read_csv("Downloads/archive/new_york_tree_species.csv")

#Data wrangling

nytrees_1995 <- nytrees_1995 %>%
  select(Spc_Common,Condition,Borough,Longitude,Latitude,Zip_New)

nytrees_2005 <- nytrees_2005 %>%
  select(spc_common,status,boroname,latitude,longitude,zipcode)

nytrees_2015 <- nytrees_2015 %>%
  select(spc_common,health,borough,latitude,longitude,postcode)

```

# Exploring Population Density and Growth, alongside Tree Health

To start our analysis, we wanted a visualization of the most basic indicator of population growth over the years: the number of trees.

```{r Population Density, echo=FALSE, out.width="130%", fig.show='hold',message=FALSE, warning=FALSE}
## creating map Visualization
##using ggmaps 

newyork.map <- get_map(location = 'New York', maptype= "hybrid",source='google',zoom=11)

#1995
ggmap(newyork.map) + geom_point(data = nytrees_1995, 
aes(x=Longitude,y=Latitude,colour = Condition),size=.05)+
  scale_color_manual(
    values = c(Dead = "#282626",
               Excellent = "#16DE0C",
               Good = "#3D6C08",
               Poor = "#E50E0E")
  ) +
  labs(
    title = "New York Tree Census 1995 map"
  ) + xlab("Longitude") + ylab("Latitude") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 15L,
                              face = "bold",
                              hjust = 0.5),
  )

#2005
ggmap(newyork.map) + geom_point(data = nytrees_2005, aes(x=longitude,y=latitude,colour = status),size=.05)+
  scale_color_manual(
    values = c(Dead = "#282626",
               Excellent = "#16DE0C",
               Good = "#3D6C08",
               Poor = "#E50E0E")
  ) +
  labs(
    title = "New York Tree Census 2005 map"
  ) +
  xlab("Longitude") + ylab("Latitude") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 15L,
                              face = "bold",
                              hjust = 0.5),
  )

#2015
ggmap(newyork.map) + 
  geom_point(data = nytrees_2015, aes(x=longitude,y=latitude,colour = health),size=.05)+
  scale_color_manual(
    values = c(Fair = "#16DE0C",
               Good = "#3D6C08",
               Poor = "#E50E0E")  
  ) +
  labs(
    title = "New York Tree Census 2015 map",
    color = "Condition of the Tree"
  ) + xlab("Longitude") + ylab("Latitude") +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 15L,
                              face = "bold",
                              hjust = 0.5),
    )
```


The figures above show that from 1995 to 2015, the number of trees have only increased. Upon further inspection, you can see that these increases are initially mostly in area, but by 2015 the trees are also incredibly dense. This dramatic increase is still continuing today, as an effort from the New York Parks department, as well as Trees for Public Health to help mitigate the effects of climate change on the city, and is arguably the cheapest way to do so. By planting more trees, New York City's Tree Canopy is growing. A tree canopy, by the simplest definition are the cover provided by trees. Tree canopies help mitigate climate change because they store CO2, resulting in less of the gas contributing to the greenhouse gases effect. Tree canopies also reduce energy use by cooling neighborhoods by up to 10 degrees, without reducing energy needs. All in all, this increase in tree population has only been benefiting the people of New York City.

To go further, we decided to track the health alongside the population growth.

```{r Comparing Health 1995, echo=FALSE, fig.show='hold', message=FALSE, warning=FALSE, out.width="50%"}
###Making Two separate graph for good and bad condition

#1995
#Good Conditions
new_nytrees_1995_good <- nytrees_1995 %>% select(Longitude,Latitude,Condition) %>% filter(Condition %in% c("Good", "Excellent"))
ggmap(newyork.map) + geom_point(data = new_nytrees_1995_good, aes(x=Longitude,y=Latitude,colour = Condition),size=.05)+
  scale_color_manual(
    values = c(Excellent = "#16DE0C",
               Good = "#3D6C08")
  ) +
  labs(
    title = "Good Health",
    color = "Condition of the Tree"
  ) +
  xlab("Longitude") + ylab("Latitude") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0.5),
  )

#Bad Conditions
new_nytrees_1995_bad <- nytrees_1995%>% select(Longitude,Latitude,Condition) %>% filter(Condition %in% c("Dead", "Poor"))
ggmap(newyork.map) + geom_point(data = new_nytrees_1995_bad, aes(x=Longitude,y=Latitude,colour = Condition),size=.05)+
  scale_color_manual(
    values = c(Dead = "#282626",
               Poor = "#E50E0E")
  ) +
  labs(
    title = "Bad Health", 
    color = "Condition of the Tree"
  ) +
  xlab("Longitude") + ylab("Latitude") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0.5),
  )
```

The figure above displays the location of all of the trees in the data set, but also notes the health of each tree. As we compare the two graphs, we can see that the trees that are dead or in poor health are in heavily industrialized areas or in less populated areas. This leads me to infer that these trees simply aren't receiving the care that they need to thrive. The trees in excellent and good health look like they are concentrated in parks, as well as being intentionally planted in the city.

```{r Comparing Health 2005, echo=FALSE, fig.show='hold', out.width= "50%", message=FALSE, warning=FALSE}


#2005
#Good Conditions
new_nytrees_2005_good <- nytrees_2005%>% select(longitude,latitude,status) %>% filter(status %in% c("Good", "Excellent"))
ggmap(newyork.map) + geom_point(data = new_nytrees_2005_good, aes(x=longitude,y=latitude,colour = status),size=.05)+
  scale_color_manual(
    values = c(Excellent = "#16DE0C",
               Good = "#3D6C08")
  ) +
  labs(
    title = "Good Health",
    color = "Condition of the Tree"
  ) +
  xlab("Longitude") + ylab("Latitude") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0.5),
  )

#Bad Conditions
new_nytrees_2005_bad <- nytrees_2005%>% select(longitude,latitude,status) %>% filter(status %in% c("Dead", "Poor"))
ggmap(newyork.map) + geom_point(data = new_nytrees_2005_bad, aes(x=longitude,y=latitude,colour = status),size=.05)+
  scale_color_manual(
    values = c(Dead = "#282626",
               Poor = "#E50E0E")
  ) +
  labs(
    title = "Bad Health", 
    color = "Condition of the Tree"
  ) +
  xlab("Longitude") + ylab("Latitude") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0.5),
  )
```

In 2005, we can see that despite the seemingly good news that the tree population had increased, many of those trees were in poor health or had already died. Some good news from this visualization is that the excellent to good ratio in the first visualization is much improved. In conclusion, in 2005, the Parks department still had a ways to go to improve their tree maintenance.

```{r Comparing Health 2015, echo=FALSE, fig.show='hold', message=FALSE, warning=FALSE, out.width="50%"}

#2015
#Good Conditions
new_nytrees_2015_good <- nytrees_2015 %>% select(longitude,latitude,health) %>% filter(health %in% c("Good", "Fair"))
ggmap(newyork.map) + geom_point(data = new_nytrees_2015_good, aes(x=longitude,y=latitude,colour = health),size=.05)+
  scale_color_manual(
    values = c(Good = "#3D6C08",
               Fair = "#16DE0C")
  ) +
  labs(
    title = "Good Health",
    color = "Condition of the Tree"
  ) +
  xlab("Longitude") + ylab("Latitude") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0.5),
  )

#Bad Conditions
new_nytrees_2015_bad <- nytrees_2015 %>% select(longitude,latitude,health) %>% filter(health %in% c("Poor"))
ggmap(newyork.map) + geom_point(data = new_nytrees_2015_bad, aes(x=longitude,y=latitude,colour = health),size=.05)+
  scale_color_manual(
    values = c(Poor = "#E50E0E")
  ) +
  labs(
    title = "Bad Health", 
    color = "Condition of the Tree"
  ) +
  xlab("Longitude") + ylab("Latitude") +
  theme_minimal() +
  theme(plot.title = element_text(face = "bold", hjust = 0.5),
  )
```

By 2015, the health of trees had had much improvement and the majority of trees appear to be in good health! The ratio of good: poor trees is much improved and the overall health of the trees in the city have grown, while also maintaining the population growth rate.

As we can see from this set of visualizations, from 1995 to 2015, not only has the number of trees increased in that time frame, the overall health of them has as well. Given the city-environment, I initally expected this trend to be the opposite. However, it is incredibly motivating to see how the effort put it by the Parks department, and other New York advocacy groups are paying off and providing some protection for New Yorkers against the growing climate crisis.

# Trees by Borough



```{r Tables- Popularity, echo=FALSE, fig.show='hold', message=FALSE, warning=FALSE, out.width="33%"}
##Borough has the most tree
#Total Number of trees in each Borough

Borough_1995 <- data.frame(sort(table(nytrees_1995$Borough), decreasing = TRUE))
Borough_2005 <- data.frame(sort(table(nytrees_2005$boroname), decreasing = TRUE))
Borough_2015 <- data.frame(sort(table(nytrees_2015$borough), decreasing = TRUE))


# Use the colnames function to specify the column names
colnames(Borough_1995) <- c("Borough", "Total Number of Trees")
colnames(Borough_2005) <- c("Borough", "Total Number")
colnames(Borough_2015) <- c("Borough", "Total Number")


# View the resulting table
#1995
kbl(head(Borough_1995, 5), caption = "Total Number of Trees in each Borough - 1995" )%>%
  kable_styling(bootstrap_options = "bordered")%>%
  kable_paper(full_width = F)

#2005
kbl(head(Borough_2005, 5), caption = "Total Number of Trees in each Borough - 2005" )%>%
  kable_styling(bootstrap_options = "bordered")%>%
  kable_paper(full_width = F)

#2015
kbl(head(Borough_2015, 5), caption = "Total Number of Trees in each Borough - 2015" )%>%
  kable_styling(bootstrap_options = "bordered")%>%
  kable_paper(full_width = F)
```

```{r Bar Charts- Popularity 1995, echo=FALSE, fig.width=15, message=FALSE, warning=FALSE}
#Using Facet Visualization on the Health/Condition of the tree per borough
##1995
nytrees_1995 %>%
  filter(Condition %in% c("Good", "Excellent", "Poor", "Dead")) %>%
  ggplot() +
  aes(x = Borough, fill = Borough) +
  geom_bar() +
  scale_fill_manual(
    values = c(Bronx = "#814198",
               Brooklyn = "#0370B7",
               Manhattan = "#E59C0C",
               Queens = "#E01D1D",
               `Staten Island` = "#4B935B")
  ) +
  labs(
    x = "Borough",
    y = "Total num of Tree",
    title = "1995 Trees Condition per Borough",
    fill = "Boroughs"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 15L,
                              face = "bold",
                              hjust = 0.5),
    axis.title.y = element_text(face = "bold"),
    axis.title.x = element_text(face = "bold")
  ) +
  facet_wrap(vars(Condition), scales = "free")
```

```{r Bar Charts- Popularity 2005, echo=FALSE, fig.width=15, message=FALSE, warning=FALSE}
#2005
ggplot(nytrees_2005) +
  aes(x = boroname, fill = boroname) +
  geom_bar() +
  scale_fill_manual(
    values = c(Bronx = "#814198",
               Brooklyn = "#0370B7",
               Manhattan = "#E59C0C",
               Queens = "#E01D1D",
               "5" = "#4B935B")
  ) +
  labs(
    x = "Borough",
    y = "Total num of Tree",
    title = "2005 Trees Condition per Borough"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 15L,
                              face = "bold",
                              hjust = 0.5),
    axis.title.y = element_text(face = "bold"),
    axis.title.x = element_text(face = "bold")
  ) +
  facet_wrap(vars(status), scales = "free")
```

```{r Bar Charts- Popularity 2015, echo=FALSE, fig.width=15, message=FALSE, warning=FALSE}
#2015
nytrees_2015 %>%
  filter(health %in% c("Good", "Fair", "Poor")) %>%
  ggplot() +
  aes(x = borough, fill = borough) +
  geom_bar() +
  scale_fill_manual(
    values = c(Bronx = "#814198",
               Brooklyn = "#0370B7",
               Manhattan = "#E59C0C",
               Queens = "#E01D1D",
               `Staten Island` = "#4B935B")
  ) +
  labs(
    x = "Borough",
    y = "Total num of Tree",
    title = "2015 Trees Condition per Borough"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 15L,
                              face = "bold",
                              hjust = 0.5),
    axis.title.y = element_text(face = "bold"),
    axis.title.x = element_text(face = "bold")
  )+
  facet_wrap(vars(health), scales = "free")


```

```{r Tree Popularity by Borough 1995, echo=FALSE, fig.width=25, message=FALSE, warning=FALSE}


#Visualization using Bar plot on the most common species per borough

#1995
species_common_1995 <- nytrees_1995 %>%
  select(Spc_Common, Borough)%>%
  group_by(Spc_Common, Borough) %>%
  summarize(count = n()) %>%
  arrange(desc(count))

trees_by_borough_1995 <- bind_rows(
  head(filter(species_common_1995, Borough == "Staten Island"),5),
  head(filter(species_common_1995, Borough == "Queens"),5),
  head(filter(species_common_1995, Borough == "Manhattan"),5),
  head(filter(species_common_1995, Borough == "Brooklyn"),5),
  head(filter(species_common_1995, Borough == "Bronx"),5)
)

ggplot(trees_by_borough_1995) +
  aes(x = Spc_Common, y = count, fill = Borough) +
  geom_col()+
    scale_fill_manual(
    values = c(Bronx = "#814198",
               Brooklyn = "#0370B7",
               Manhattan = "#E59C0C",
               Queens = "#E01D1D",
               `Staten Island` = "#4B935B")
  ) +
  labs(
    x = "Tree Species",
    y = "Count",
    title = "Top Five Most Common Species per Borough - 1995"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 18L,
                              face = "bold",
                              hjust = 0.5),
    axis.title.y = element_text(face = "bold"),
    axis.title.x = element_text(face = "bold")
  ) +
  facet_wrap(vars(Borough), scales = "free")
```

```{r Tree Popularity by Borough 2005, echo=FALSE, fig.width=25, message=FALSE, warning=FALSE}
#2005
species_common_2005 <- nytrees_2005 %>%
  select(spc_common, boroname)%>%
  group_by(spc_common, boroname) %>%
  summarize(count = n()) %>%
  arrange(desc(count))

trees_by_borough_2005 <- bind_rows(
  head(filter(species_common_2005, boroname == "5"),5),
  head(filter(species_common_2005, boroname == "Queens"),5),
  head(filter(species_common_2005, boroname == "Manhattan"),5),
  head(filter(species_common_2005, boroname == "Brooklyn"),5),
  head(filter(species_common_2005, boroname == "Bronx"),5)
)

ggplot(trees_by_borough_2005) +
  aes(x = spc_common, y = count, fill = boroname) +
  geom_col() +
  scale_fill_manual(
    values = c(Bronx = "#814198",
               Brooklyn = "#0370B7",
               Manhattan = "#E59C0C",
               Queens = "#E01D1D",
               "5" = "#4B935B")
  ) +
  labs(
    x = "Tree Species",
    y = "Count",
    title = "Top Five Most Common Species per Borough - 2005"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 18L,
                              face = "bold",
                              hjust = 0.5),
    axis.title.y = element_text(face = "bold"),
    axis.title.x = element_text(face = "bold")
  ) +
  facet_wrap(vars(boroname), scales = "free")
```

```{r Tree Popularity by Borough 2015, echo=FALSE, fig.width=25, message=FALSE, warning=FALSE}
#2015
species_common_2015 <- nytrees_2015 %>%
  select(spc_common, borough)%>%
  group_by(spc_common, borough) %>%
  summarize(count = n()) %>%
  arrange(desc(count))

trees_by_borough_2015 <- bind_rows(
  head(filter(species_common_2015, borough == "Staten Island"),5),
  head(filter(species_common_2015, borough == "Queens"),5),
  head(filter(species_common_2015, borough == "Manhattan"),5),
  head(filter(species_common_2015, borough == "Brooklyn"),5),
  head(filter(species_common_2015, borough == "Bronx"),5)
)

ggplot(trees_by_borough_2015) +
  aes(x = spc_common, y = count, fill = borough) +
  geom_col() +
  scale_fill_manual(
    values = c(Bronx = "#814198",
               Brooklyn = "#0370B7",
               Manhattan = "#E59C0C",
               Queens = "#E01D1D",
               `Staten Island` = "#4B935B")
  ) +
  labs(
    x = "Tree Species",
    y = "Count",
    title = "Top Five Most Common Species per Borough - 2015"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 18L,
                              face = "bold",
                              hjust = 0.5),
    axis.title.y = element_text(face = "bold"),
    axis.title.x = element_text(face = "bold")
  ) +
  facet_wrap(vars(borough), scales = "free")
```

```{r Tree Condition 1995, echo=FALSE, fig.width=15, message=FALSE, warning=FALSE}
##The most common species given the Health Condition 
##Creating a Bar plot Visualisation
#1995

Nytrees_1995 <- nytrees_1995 %>%
  select(Spc_Common, Condition)%>%
  group_by(Spc_Common, Condition) %>%
  summarize(count = n()) %>%
  arrange(desc(count))

trees_by_condition_1995 <- bind_rows(
  head(filter(Nytrees_1995, Condition == "Excellent"),5),
  head(filter(Nytrees_1995, Condition == "Good"),5),
  head(filter(Nytrees_1995, Condition == "Poor"),5),
  head(filter(Nytrees_1995, Condition == "Dead"),5)
)

##Visualization 
ggplot(trees_by_condition_1995) +
  aes(x = Spc_Common, y = count) +
  geom_col(fill = "#053E05") +
  labs(
    x = "Tree Species ",
    y = "Count",
    title = "Top Five Tree Species given their Health Condition - 1995"
  ) +
  theme_minimal() +
  facet_wrap(vars(Condition), scales = "free")
```

```{r Tree Condition 2005, echo=FALSE, fig.width=15, message=FALSE, warning=FALSE}
#2005

Nytrees_2005 <- nytrees_2005 %>%
  select(spc_common, status)%>%
  group_by(spc_common, status) %>%
  summarize(count = n()) %>%
  arrange(desc(count))

trees_by_condition_2005 <- bind_rows(
  head(filter(Nytrees_2005, status == "Excellent"),5),
  head(filter(Nytrees_2005, status == "Good"),5),
  head(filter(Nytrees_2005, status == "Poor"),5),
  head(filter(Nytrees_2005, status == "Dead"),5)
)

##Visualization
ggplot(trees_by_condition_2005) +
  aes(x = spc_common, y = count) +
  geom_col(fill = "#053E05") +
  labs(
    x = "Tree Species ",
    y = "Count",
    title = "Top Five Tree Species given their Health Condition - 2005"
  ) +
  theme_minimal() +
  facet_wrap(vars(status), scales = "free")
```

```{r Tree Condition 2015, echo=FALSE, fig.width=17, message=FALSE, warning=FALSE}
#2015 

Nytrees_2015 <- nytrees_2015 %>%
  select(spc_common, health)%>%
  group_by(spc_common, health) %>%
  summarize(count = n()) %>%
  arrange(desc(count))

trees_by_condition_2015 <- bind_rows(
  head(filter(Nytrees_2015, health == "Excellent"),5),
  head(filter(Nytrees_2015, health == "Good"),5),
  head(filter(Nytrees_2015, health == "Fair"),5),
  head(filter(Nytrees_2015, health == "Poor"),5)
)

##Visualization 
ggplot(trees_by_condition_2015) +
  aes(x = spc_common, y = count) +
  geom_col(fill = "#053E05") +
  labs(
    x = "Tree Species ",
    y = "Count",
    title = "Top Five Tree Species given their Health Condition - 2015"
  ) +
  theme_minimal() +
  facet_wrap(vars(health), scales = "free")
```

```{r Most Popular Species Tables, echo=FALSE, fig.show='hold', message=FALSE, warning=FALSE, out.width="33%"}
#most popular tree species
mostPopular_1995 <- data.frame(sort(table(nytrees_1995$Spc_Common), decreasing = TRUE))
mostPopular_2005 <- data.frame(sort(table(nytrees_2005$spc_common), decreasing = TRUE))
mostPopular_2015 <- data.frame(sort(table(nytrees_2015$spc_common), decreasing = TRUE))


# Use the colnames function to specify the column names
colnames(mostPopular_1995) <- c("Tree Species", "Total Number")
colnames(mostPopular_2005) <- c("Tree Species", "Total Number")
colnames(mostPopular_2015) <- c("Tree Species", "Total Number")

# View the resulting table 
#1995
kbl(head(mostPopular_1995, 5), caption = "Top 5 common tree Species in 1995" )%>%
  kable_styling(bootstrap_options = "bordered")%>%
  kable_paper(full_width = F)

#2005
kbl(head(mostPopular_2005, 5), caption = "Top 5 common tree Species in 2005" )%>%
  kable_styling(bootstrap_options = "bordered")%>%
  kable_paper(full_width = F)

#2015
kbl(head(mostPopular_2015, 5), caption = "Top 5 common tree Species in 2015" )%>%
  kable_styling(bootstrap_options = "bordered")%>%
  kable_paper(full_width = F)

```

# Exploring the most Popular Species further

Seeing as the most popular species haven't really changed, we decided to track those specific species health accross the years in each borough.

```{r Most Popular and Health 1995, echo=FALSE, fig.width=11, message=FALSE, warning=FALSE}

mostPop1995 <- nytrees_1995 %>%
    group_by(Spc_Common) %>%
    summarise(count = n()) %>%
    top_n(n = 5, wt = count)

mostPopData1995 <- filter(nytrees_1995, Spc_Common == c("HONEYLOCUST","LONDON PLANETREE","MAPLE, NORWAY", "OAK, PIN","PEAR, CALLERY"))

mostPopFinal1995 <- mostPopData1995 %>%
    group_by(Spc_Common, Borough, Condition) %>%
    summarise(count = n()) %>%
    top_n(n = 5, wt = count)

ggplot(
  data = mostPopFinal1995, 
  aes(x = Condition, y = count, fill = Spc_Common)) +
  geom_col() +
  facet_wrap(.~Borough, scales = "free") +
  theme_minimal() + 
  xlab("Condition of Tree (Scale of Dead to Excellent, including Unknown)")+
  ylab("Count of Trees") +
  ggtitle("The Health of the Most Popular Tree Species in 1995 by Borough")+
  labs(fill = "5 Most Popular Species")
  
```

```{r Most Popular and Health 2005, echo=FALSE, fig.width=10, message=FALSE}

mostPop2005 <- nytrees_2005 %>%
    group_by(spc_common) %>%
    summarise(count = n()) %>%
    top_n(n = 5, wt = count)

mostPopData2005 <- filter(nytrees_2005, spc_common == c("HONEYLOCUST","LONDON PLANETREE","MAPLE, NORWAY", "OAK, PIN","PEAR, CALLERY"))

mostPopFinal2005 <- mostPopData2005 %>%
    group_by(spc_common, boroname, status) %>%
    summarise(count = n()) %>%
    top_n(n = 5, wt = count)

ggplot(
  data = mostPopFinal2005, 
  aes(x = status, y = count, fill = spc_common)) +
  geom_col() +
  facet_wrap(.~boroname, scales = "free") +
  theme_minimal() + 
  xlab("Condition of Tree (Scale of Dead to Excellent, including Unknown)")+
  ylab("Count of Trees") +
  ggtitle("The Health of the Most Popular Tree Species in 2005 by Borough")+
  labs(fill = "5 Most Popular Species")
  
```

```{r Most Popular and Health 2015, echo=FALSE, fig.width=10, message=FALSE, warning=FALSE}

mostPop2015 <- nytrees_2015 %>%
    group_by(spc_common) %>%
    summarise(count = n()) %>%
    top_n(n = 5, wt = count)

mostPopData2015 <- filter(nytrees_2015, spc_common == c("Callery pear","honeylocust","London planetree", "Norway maple","pin oak"))

mostPopFinal2015 <- mostPopData2015 %>%
    group_by(spc_common, borough, health) %>%
    summarise(count = n()) %>%
    top_n(n = 5, wt = count)

ggplot(
  data = mostPopFinal2015, 
  aes(x = health, y = count, fill = spc_common)) +
  geom_col() +
  facet_wrap(.~borough, scales = "free") +
  theme_minimal() + 
  xlab("Condition of Tree (Scale of Dead to Excellent, including Unknown)")+
  ylab("Count of Trees") +
  ggtitle("The Health of the Most Popular Tree Species in 2015 by Borough")+
  labs(fill = "5 Most Popular Species")
  
```

```{r Trackdown, eval=FALSE, include=FALSE}

trackdown::upload_file(
file = "TrackdownDemo.Rmd",
hide_code = TRUE,
rich_text = TRUE,
path_output = "TrackdownDemo.pdf"
)
trackdown::update_file(
file = "TrackdownDemo.Rmd",
hide_code = TRUE,
rich_text = TRUE,
path_output = "TrackdownDemo.pdf"
)
trackdown::download_file(
file = "TrackdownDemo.Rmd"
)
trackdown::render_file(
file = "TrackdownDemo.Rmd"
```
